# ARE — Решение алгебраического уравнения Риккати (метод Шура)


Код решает непрерывное **алгебраическое уравнение Риккати (ARE)** 

$$A^T P + P A - P B R^{-1} B^T P + Q = 0,$$

используя **гамильтонову матрицу** и **метод Шура**: QR-алгоритм на преобразованиях Хаусхолдера для собственных значений и **метод обратных итераций** для собственных векторов.

---

## Возможности
- Построение матрицы Гамильтона \(H\) из входных \(A,B,Q,R\).
- **QR-разложение** на отражениях Хаусхолдера и **QR-алгоритм со сдвигами**.
- Поиск собственных векторов методом **обратных итераций**.
- Восстановление решения \(P\) по блочной формуле Шура.
- Проверка: подстановка \(P\) в ARE и вывод нормы остатка.

---

## Структура репозитория 
```
ARE-Schur/
├─ src/
│  ├─ matrix.hpp / matrix.cpp            # Базовые операции с матрицами
│  ├─ qr.hpp / qr.cpp                    # Householder-QR, QR-алгоритм со сдвигом
│  ├─ gauss.hpp / gauss.cpp              # Гаусс (решение СЛАУ), инверсия матрицы
│  ├─ inversePower.hpp / inversePower.cpp# Обратные итерации, сборка L
│  ├─ hamiltonian.cpp                    # Построение H из A,B,Q,R
│  └─ main.cpp                           # Точка входа
├─ data/
│  ├─ A.txt  B.txt  Q.txt  R.txt         # Примеры входных матриц
├─ tests/                                 # Набор тестов и результаты
└─ README.md
```

---

## Формат входных файлов
Каждый файл содержит сначала две размерности, далее элементы по строкам:

```
<n_rows> <n_cols>
a11 a12 ... a1n
...
an1 an2 ... ann
```

- `A.txt` — \(n\times n\)
- `B.txt` — \(n\times m\)
- `Q.txt` — симм. неотрицательно определённая \(n\times n\)
- `R.txt` — симм. положительно определённая \(m\times m\)

Несогласованные размерности корректно обрабатываются сообщением об ошибке.

---

## Сборка
### g++ 
```bash
g++ -std=c++20 -O3 \
  src/matrix.cpp src/qr.cpp src/gauss.cpp src/balancing.cpp \
  src/inversePower.cpp src/hamiltonian.cpp src/main.cpp \
  -o are_schur
```

---

## ▶️ Запуск
```bash
./are_schur
```
Вывод включает найденную матрицу **P** и норму остатка \(\|A^T P + P A - P B R^{-1} B^T P + Q\|\).

---

## Математическая идея (кратко)
1. Сформировать гамильтонову матрицу
   $H = \begin{bmatrix} A & -B R^{-1} B^T \\ -Q & -A^T \end{bmatrix}.$
2. Найти спектр и базис устойчивого инвариантного подпространства \(\mathcal{S}\) матрицы \(H\):
   - QR со сдвигами → собственные значения;
   - Обратные итерации → собственные векторы и матрица \(U = \begin{bmatrix} U_{11} & U_{12} \\ U_{21} & U_{22} \end{bmatrix}.\)
3. Решение ARE восстанавливается по формуле Шура:
   $P = U_{21} U_{11}^{-1}.$

> В реализации предполагается вещественный спектр \(H\) и корректная разбида базиса на устойчивую часть.

---

## ⏱️ Сложность
- Householder-QR: \(\mathcal{O}(n^3)\)
- QR со сдвигом (в сумме): \(\mathcal{O}(n^3 k_{qr})\)
- Обратные итерации: \(\mathcal{O}(n^3 k_{ip})\) (решения СЛАУ)
- Итог (асимпт.): \(\mathcal{O}(n^3 (k_{qr}+k_{ip}))\).

Замеры на Ryzen 9 5900HX, g++ 13.1.0, компиляция производится без дополнительных флагов оптимизации:

| n  | Время |
|----|-------|
|  2 | ~1.01e-3 s |
|  4 | ~5.28e-3 s |
| 10 | ~2.01e-2 s |
| 16 | ~8.6e-1 s |
| 32 | ~1.63e+1 s |



---

## Тесты
В каталоге `data/` приведены примеры матриц для \(n=10\), а в `tests/` - результаты . После вычисления \(P\) программа печатает норму остатка — она должна быть близка к нулю (с учётом ошибок округления).

---

## ⚠️ Ограничения и примечания
- Требуется невырожденность блоков и корректная отделимость устойчивого подпространства.
- При плохо обусловленных `R`/`Q` возможна потеря устойчивости.

---


